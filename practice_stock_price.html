<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title docid="3000">ç¶œåˆç·´ç¿’ï¼šæŠ“å– TSMC è‚¡ç¥¨æ­·å²åƒ¹æ ¼</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/chatbot.css">	
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
	<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
	<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
	<script type="text/javascript" src="js/script.js"></script>	
	<!-- Prism.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.css">
    <!-- Prism.js Line Numbers CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <!-- Prism.js Syntax Highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <!-- Prism.js Line Numbers Plugin -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", (event) => {
			// includeHTML(highlightItem);				
			document.getElementById("toggleNav").addEventListener("click", navClick);		
			enableAnswerRevealer();
		});
	</script>	
</head>
<body>
	<div id="login-modal-overlay" class="modal-backdrop">
		<div class="modal-content">
			<div class="modal-icon">ğŸ”</div>
			<h2 id="modal-message">è«‹ç™»å…¥å¾ŒæŸ¥çœ‹èª²ç¨‹</h2>
			<button onclick="handleLoginClick()" class="login-confirm-btn">
				ğŸ”‘ ç™»å…¥ç³»çµ±
			</button>
		</div>
	</div>
    <div class="d-flex">
        <!-- Floating Button -->
        <button id="toggleNav" class="btn btn-primary">&#8212;</button>
        <nav id="sidebar" class="bg-light border-end" style="display: block;">
            <div>
                <div w3-include-html="navigation.html"></div>
            </div>
        </nav>
        <main class="flex-grow-1">
            <header>
                <h1>ç¶œåˆç·´ç¿’ï¼šæŠ“å– TSMC è‚¡ç¥¨æ­·å²åƒ¹æ ¼</h1>
            </header>
            <section>
                <h2>å­¸ç¿’å°è¦½</h2>
                <p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘å€‘å°‡å­¸ç¿’å¦‚ä½•åˆ©ç”¨ Python æŠ“å– TSMCï¼ˆå°ç©é›»ï¼‰çš„æ­·å²è‚¡åƒ¹ï¼Œä¸¦å°‡æ•¸æ“šå­˜å„²åˆ° CSV æ–‡ä»¶ä¸­ã€‚æˆ‘å€‘æœƒæ¢è¨ç¨‹å¼çš„åŸºæœ¬æ¶æ§‹ï¼Œä¸¦ä¸€æ­¥æ­¥å¯¦ç¾åŠŸèƒ½ã€‚</p>
                <ul>
                    <li>ä»‹ç´¹ç¨‹å¼çš„æ¶æ§‹èˆ‡é‚è¼¯ã€‚</li>
                    <li>ä½¿ç”¨ <code>yfinance</code> æ¨¡çµ„ç²å–è‚¡ç¥¨æ•¸æ“šã€‚</li>
                    <li>å°‡æŠ“å–çš„æ•¸æ“šå„²å­˜åˆ° CSV æ–‡ä»¶ä¸­ã€‚</li>
                    <li>è™•ç†ä¾‹å¤–ç‹€æ³ï¼Œç¢ºä¿ç¨‹å¼ç©©å®šåŸ·è¡Œã€‚</li>
                </ul>
                <p>å®Œæˆæœ¬ç« å¾Œï¼Œä½ å°‡èƒ½ç†Ÿç·´ä½¿ç”¨ Python æŠ“å–ä¸¦åˆ†æè‚¡ç¥¨æ•¸æ“šã€‚</p>
            </section>           

			<section>
                <h2>å¦‚ä½•å®‰è£ yfinance</h2>
                <p>åœ¨æ’°å¯«æœ¬ç« ç¨‹å¼ä¹‹å‰ï¼Œå¿…é ˆå…ˆå®‰è£ <code>yfinance</code> æ¨¡çµ„ã€‚ä»¥ä¸‹æ˜¯ä¸åŒå®‰è£æ–¹å¼çš„è©³ç´°èªªæ˜ï¼š</p>

                <h3>åœ¨ Thonny ä¸­å®‰è£</h3>
                <ol>
                    <li>æ‰“é–‹ Thonny é–‹ç™¼ç’°å¢ƒã€‚</li>
                    <li>é»æ“Šé¸å–®ä¸­çš„ <strong>å·¥å…· (Tools)</strong>ï¼Œç„¶å¾Œé¸æ“‡ <strong>ç®¡ç†å¥—ä»¶ (Manage Packages)</strong>ã€‚</li>
                    <li>åœ¨å½ˆå‡ºçš„è¦–çª—ä¸­ï¼Œæ–¼æœç´¢æ¡†è¼¸å…¥ <code>yfinance</code>ã€‚</li>
                    <li>é»æ“Š <strong>å®‰è£ (Install)</strong> æŒ‰éˆ•ï¼Œç­‰å¾…å®‰è£å®Œæˆã€‚</li>
                </ol>

                <h3>ä½¿ç”¨ pip å®‰è£</h3>
                <p>è‹¥ä½ ä½¿ç”¨å…¶ä»–é–‹ç™¼ç’°å¢ƒï¼Œå‰‡å¯ä»¥é€šéä»¥ä¸‹æŒ‡ä»¤å®‰è£ï¼š</p>
                <pre class="line-numbers"><code class="language-python">pip install yfinance</code></pre>

                <h3>æª¢æŸ¥å®‰è£</h3>
                <p>å®‰è£å®Œæˆå¾Œï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ç¢ºèªæ˜¯å¦å®‰è£æˆåŠŸï¼š</p>
                <pre class="line-numbers"><code class="language-python">pip show yfinance</code></pre>
                <p>å¦‚æœå·²æˆåŠŸå®‰è£ï¼Œå°‡é¡¯ç¤º yfinance çš„è©³ç´°è³‡è¨Šã€‚</p>
            </section>
			
<section>
            <h2>ç¨‹å¼æ¶æ§‹è§£æ</h2>

            <h3>1. è¨­å®šåƒæ•¸</h3>
            <p>ç¨‹å¼ä¸­å®šç¾©äº†ä»¥ä¸‹é‡è¦åƒæ•¸ï¼š</p>
            <ul>
                <li><strong>STOCK_CODEï¼š</strong>æŒ‡å®šè¦æŠ“å–çš„è‚¡ç¥¨ä»£ç¢¼ï¼Œå¦‚å°ç©é›»ç‚º <code>2330.TW</code>ã€‚</li>
                <li><strong>START_DATE èˆ‡ END_DATEï¼š</strong>æŒ‡å®šæŠ“å–çš„æ™‚é–“ç¯„åœï¼Œä¾‹å¦‚å¾ <code>2022-01-01</code> åˆ° <code>2023-01-01</code>ã€‚</li>
                <li><strong>CSV_FILEï¼š</strong>æŒ‡å®šè¼¸å‡ºçš„ CSV æª”æ¡ˆåç¨±ã€‚</li>
            </ul>
            <pre class="line-numbers"><code class="language-python"># è‚¡ç¥¨ä»£ç¢¼
STOCK_CODE = "2330.TW"

# æ—¥æœŸç¯„åœ
START_DATE = "2022-01-01"
END_DATE = "2023-01-01"

# è¼¸å‡ºæª”æ¡ˆåç¨±
CSV_FILE = "tsmc_stock_data.csv"</code></pre>

            <h3>2. å®šç¾©å‡½å¼</h3>
            <h4>2.1 æŠ“å–æ•¸æ“šå‡½å¼ <code>fetch_stock_data</code></h4>
            <p>æ­¤å‡½å¼ä½¿ç”¨ <code>yfinance</code> æŠ“å–æŒ‡å®šè‚¡ç¥¨çš„æ­·å²æ•¸æ“šï¼š</p>
            <pre class="line-numbers"><code class="language-python">def fetch_stock_data(stock_code, start_date, end_date):
    try:
        stock = yf.Ticker(stock_code)
        hist = stock.history(start=start_date, end=end_date)
        return hist
    except Exception as e:
        print(f"ç„¡æ³•æŠ“å–æ•¸æ“š: {e}")
        return None</code></pre>
            <p>ä¸»è¦æ­¥é©Ÿï¼š</p>
            <ol>
                <li>åˆ©ç”¨ <code>yfinance.Ticker</code> åˆå§‹åŒ–è‚¡ç¥¨ç‰©ä»¶ã€‚</li>
                <li>æŠ“å–æŒ‡å®šæ—¥æœŸç¯„åœå…§çš„æ­·å²æ•¸æ“šã€‚</li>
                <li>è‹¥æŠ“å–å¤±æ•—ï¼Œé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ã€‚</li>
            </ol>

            <h4>2.2 å„²å­˜æ•¸æ“šå‡½å¼ <code>save_to_csv</code></h4>
            <p>å°‡æŠ“å–çš„æ•¸æ“šå­˜å„²ç‚º CSV æ–‡ä»¶ï¼š</p>
            <pre class="line-numbers"><code class="language-python">def save_to_csv(data, filename):
    try:
        data.reset_index(inplace=True)
        data["Date"] = data["Date"].apply(lambda x: x.strftime("%Y-%m-%d"))
        data.to_csv(filename, index=False, encoding="utf-8-sig")
        print(f"æ•¸æ“šå·²å„²å­˜åˆ° {filename}")
    except Exception as e:
        print(f"ç„¡æ³•å„²å­˜æ•¸æ“šåˆ° CSV: {e}")</code></pre>
            <p>ä¸»è¦æ­¥é©Ÿï¼š</p>
            <ol>
                <li>é‡è¨­ç´¢å¼•ï¼Œå°‡æ—¥æœŸåˆ—æå–å‡ºä¾†ã€‚</li>
                <li>æ ¼å¼åŒ–æ—¥æœŸç‚º <code>YYYY-MM-DD</code> æ ¼å¼ã€‚</li>
                <li>å°‡æ•¸æ“šä¿å­˜åˆ° CSV æ–‡ä»¶ï¼Œä½¿ç”¨ <code>utf-8-sig</code> ç·¨ç¢¼ä»¥æ”¯æ´ä¸­æ–‡ã€‚</li>
            </ol>

            <h3>3. ä¸»ç¨‹å¼é‚è¼¯</h3>
            <p>æ•´å€‹ç¨‹å¼çš„ä¸»é‚è¼¯å¯«åœ¨ <code>if __name__ == "__main__"</code> å€å¡Šä¸­ï¼š</p>
            <pre class="line-numbers"><code class="language-python">if __name__ == "__main__":
    print("æ­£åœ¨æŠ“å– TSMC è‚¡ç¥¨æ•¸æ“š...")
    stock_data = fetch_stock_data(STOCK_CODE, START_DATE, END_DATE)
    if stock_data is not None:
        save_to_csv(stock_data, CSV_FILE)
    else:
        print("æŠ“å–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¨‹å¼è¨­å®šã€‚")</code></pre>
            <p>æ­¥é©Ÿï¼š</p>
            <ol>
                <li>è¼¸å‡ºè¨Šæ¯æç¤ºæŠ“å–é–‹å§‹ã€‚</li>
                <li>èª¿ç”¨ <code>fetch_stock_data</code> æŠ“å–æ•¸æ“šã€‚</li>
                <li>å¦‚æœæŠ“å–æˆåŠŸï¼Œèª¿ç”¨ <code>save_to_csv</code> å„²å­˜æ•¸æ“šï¼›å¦å‰‡è¼¸å‡ºéŒ¯èª¤è¨Šæ¯ã€‚</li>
            </ol>
        </section>
			
			
            <section>
                <h2>å®Œæ•´ç¯„ä¾‹ç¨‹å¼ç¢¼</h2>
                <pre class="line-numbers"><code class="language-python">import yfinance as yf
import csv
from datetime import datetime

# è‚¡ç¥¨ä»£ç¢¼
STOCK_CODE = "2330.TW"

# è¨­å®šæŠ“å–çš„æ—¥æœŸç¯„åœ
START_DATE = "2022-01-01"
END_DATE = "2023-01-01"

# è¼¸å‡º CSV çš„æª”æ¡ˆåç¨±
CSV_FILE = "tsmc_stock_data.csv"

# æŠ“å–æ•¸æ“š
def fetch_stock_data(stock_code, start_date, end_date):
    try:
        stock = yf.Ticker(stock_code)
        hist = stock.history(start=start_date, end=end_date)
        return hist
    except Exception as e:
        print(f"ç„¡æ³•æŠ“å–æ•¸æ“š: {e}")
        return None

# å°‡æ•¸æ“šå„²å­˜ç‚º CSV
def save_to_csv(data, filename):
    try:
        data.reset_index(inplace=True)
        data["Date"] = data["Date"].apply(lambda x: x.strftime("%Y-%m-%d"))
        data.to_csv(filename, index=False, encoding="utf-8-sig")
        print(f"æ•¸æ“šå·²å„²å­˜åˆ° {filename}")
    except Exception as e:
        print(f"ç„¡æ³•å„²å­˜æ•¸æ“šåˆ° CSV: {e}")

# ä¸»ç¨‹å¼
if __name__ == "__main__":
    print("æ­£åœ¨æŠ“å– TSMC è‚¡ç¥¨æ•¸æ“š...")
    stock_data = fetch_stock_data(STOCK_CODE, START_DATE, END_DATE)
    if stock_data is not None:
        save_to_csv(stock_data, CSV_FILE)
    else:
        print("æŠ“å–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¨‹å¼è¨­å®šã€‚")</code></pre>
            </section>





            <section>
                <h2>æŒ‘æˆ°é¡Œç›®</h2>
<div class="challenge-item" id="challenge-1">				
                <h3 class="caption">æŒ‘æˆ° 1ï¼šæŠ“å–å…¶ä»–è‚¡ç¥¨æ•¸æ“š <span class="icon">ğŸ›ˆ</span></h3>
    <p>å˜—è©¦ä¿®æ”¹ç¨‹å¼ä»¥æŠ“å–å…¶ä»–è‚¡ç¥¨çš„æ­·å²æ•¸æ“šï¼Œä¾‹å¦‚ Apple (<code>AAPL</code>)ã€‚</p>
    <div class="answer">
        <pre class="line-numbers"><code class="language-python"># è§£ç­”
import yfinance as yf

# è‚¡ç¥¨ä»£ç¢¼
STOCK_CODE = "AAPL"  # Apple çš„è‚¡ç¥¨ä»£ç¢¼
START_DATE = "2022-01-01"
END_DATE = "2023-01-01"

def fetch_stock_data(stock_code, start_date, end_date):
    try:
        stock = yf.Ticker(stock_code)
        hist = stock.history(start=start_date, end=end_date)
        print(hist)
    except Exception as e:
        print(f"ç„¡æ³•æŠ“å–æ•¸æ“š: {e}")

fetch_stock_data(STOCK_CODE, START_DATE, END_DATE)
</code></pre>
    </div>
</div>

<div class="challenge-item" id="challenge-2">
    <h3 class="caption">æŒ‘æˆ° 2ï¼šå¢åŠ æ•¸æ“šåˆ†æåŠŸèƒ½ <span class="icon">ğŸ›ˆ</span></h3>
    <p>å°‡æŠ“å–çš„æ•¸æ“šé€²è¡ŒåŸºæœ¬çš„çµ±è¨ˆåˆ†æï¼Œä¾‹å¦‚è¨ˆç®—å¹³å‡åƒ¹æ ¼æˆ–æœ€å¤§æ¼²è·Œå¹…ã€‚</p>
    <div class="answer">
        <pre class="line-numbers"><code class="language-python"># è§£ç­”
import yfinance as yf

STOCK_CODE = "2330.TW"  # å°ç©é›»
START_DATE = "2022-01-01"
END_DATE = "2023-01-01"

def fetch_and_analyze(stock_code, start_date, end_date):
    try:
        stock = yf.Ticker(stock_code)
        hist = stock.history(start=start_date, end=end_date)
        
        avg_price = hist['Close'].mean()
        max_change = (hist['High'] - hist['Low']).max()

        print(f"å¹³å‡æ”¶ç›¤åƒ¹ï¼š{avg_price:.2f}")
        print(f"æœ€å¤§æ—¥å…§æ³¢å‹•ï¼š{max_change:.2f}")
    except Exception as e:
        print(f"éŒ¯èª¤ï¼š{e}")

fetch_and_analyze(STOCK_CODE, START_DATE, END_DATE)
</code></pre>
    </div>
</div>

<div class="challenge-item" id="challenge-3">
    <h3 class="caption">æŒ‘æˆ° 3ï¼šå¯è¦–åŒ–æ•¸æ“š <span class="icon">ğŸ›ˆ</span></h3>
    <p>ä½¿ç”¨ <code>matplotlib</code> æˆ–å…¶ä»–ç¹ªåœ–å·¥å…·å°‡æ•¸æ“šå¯è¦–åŒ–ï¼Œä¾‹å¦‚ç¹ªè£½è‚¡åƒ¹è¶¨å‹¢åœ–ã€‚</p>
    <div class="answer">
        <pre class="line-numbers"><code class="language-python"># è§£ç­”
import yfinance as yf
import matplotlib.pyplot as plt

STOCK_CODE = "2330.TW"
START_DATE = "2022-01-01"
END_DATE = "2023-01-01"

def fetch_and_visualize(stock_code, start_date, end_date):
    try:
        stock = yf.Ticker(stock_code)
        hist = stock.history(start=start_date, end=end_date)
        
        plt.figure(figsize=(10, 5))
        plt.plot(hist.index, hist['Close'], label='æ”¶ç›¤åƒ¹', color='blue')
        plt.title(f"{stock_code} è‚¡åƒ¹è¶¨å‹¢")
        plt.xlabel("æ—¥æœŸ")
        plt.ylabel("æ”¶ç›¤åƒ¹")
        plt.legend()
        plt.grid()
        plt.show()
    except Exception as e:
        print(f"éŒ¯èª¤ï¼š{e}")

fetch_and_visualize(STOCK_CODE, START_DATE, END_DATE)
</code></pre>
    </div>
</div>
            </section>

            <section>
                <h2>çµèª</h2>
                <p>é€éæœ¬ç« çš„å­¸ç¿’ï¼Œæˆ‘å€‘äº†è§£äº†å¦‚ä½•ä½¿ç”¨ Python æŠ“å–ä¸¦å„²å­˜è‚¡ç¥¨æ•¸æ“šã€‚é€™æ˜¯ä¸€å€‹çµåˆç¶²è·¯çˆ¬èŸ²ã€æ•¸æ“šè™•ç†èˆ‡æª”æ¡ˆæ“ä½œçš„å¯¦ç”¨æ¡ˆä¾‹ï¼Œå¸Œæœ›ä½ èƒ½é€²ä¸€æ­¥æ“´å±•ä¸¦æ‡‰ç”¨æ–¼æ›´å¤šå ´æ™¯ï¼</p>
            </section>
        </main>
		
		<!-- å…¨åŸŸèŠå¤©æ©Ÿå™¨äººå®¹å™¨ï¼ˆåªéœ€è¦ä¸€å€‹ï¼‰ -->
		<div id="chatbot-container" class="chatbot-docked chatbot-docked-right" style="display: none;">
			<div class="chatbot-window">
				<div class="chatbot-header">
					<div class="chatbot-header-left">
						<span class="chatbot-title" id="chatbot-title">ğŸ¤– Python å­¸é•·</span>
						
					</div>
					<div class="chatbot-header-right">
						<button class="chatbot-jump-btn" id="chatbot-jump-btn" onclick="jumpToChallenge()" title="è·³è½‰åˆ°æŒ‘æˆ°ä½ç½®">ğŸš©</button>
						<!-- åœé ä½ç½®æŒ‰éˆ• -->
						<button class="chatbot-dock-btn" id="dock-right-btn" onclick="dockChatbot('right')" title="åœé å³å´">
							â–·
						</button>
						<button class="chatbot-dock-btn" id="dock-bottom-btn" onclick="dockChatbot('bottom')" title="åœé åº•éƒ¨">
							â–½
						</button>
						<!--button class="chatbot-dock-btn" onclick="dockChatbot('top')" title="åœé é ‚éƒ¨">
							â–³
						</button-->
						<button class="chatbot-close" onclick="closeChatbot()">âœ•</button>
					</div>
				</div>
								
				<!-- èª¿æ•´å¤§å°çš„æ‹–æ›³æŸ„ -->
				<div class="chatbot-resizer" id="chatbot-resizer"></div>
				
				<div class="chatbot-messages" id="chatbot-messages"></div>
				<div class="chatbot-input">
					<textarea 
						id="chatbot-input" 
						placeholder="è¼¸å…¥ä½ çš„å›ç­”æˆ–å•é¡Œ...ï¼ˆShift+Enter æ›è¡Œï¼ŒEnter ç™¼é€ï¼‰" 
						onkeydown="handleKeyPress(event)"
						rows="1"></textarea>
					<button id="chatbot-send-btn" onclick="sendMessage()">ç™¼é€</button>
					<button id="chatbot-summary-btn" onclick="generateSummary()">ğŸ“Š</button>
				</div>
			</div>
		</div>

		<script src="js/auth.js"></script>
		<script src="js/chatbot.js"></script>
		
    </div>
</body>
</html>
